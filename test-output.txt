[INFO] Scanning for projects...
[INFO] 
[INFO] ----------------------< com.economato:inventory >-----------------------
[INFO] Building inventory 1.6-RELEASE
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[WARNING] The artifact com.itextpdf:itext7-core:pom:8.0.5 has been relocated to com.itextpdf:itext-core:pom:8.0.5
[INFO] 
[INFO] --- jacoco:0.8.12:prepare-agent (prepare-agent) @ inventory ---
[INFO] argLine set to -javaagent:/home/franchu/.m2/repository/org/jacoco/org.jacoco.agent/0.8.12/org.jacoco.agent-0.8.12-runtime.jar=destfile=/home/franchu/Escritorio/Cosas/turing/target/jacoco.exec
[INFO] 
[INFO] --- resources:3.3.1:resources (default-resources) @ inventory ---
[INFO] Copying 1 resource from src/main/resources to target/classes
[INFO] Copying 4 resources from src/main/resources to target/classes
[INFO] 
[INFO] --- compiler:3.13.0:compile (default-compile) @ inventory ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- resources:3.3.1:testResources (default-testResources) @ inventory ---
[INFO] Copying 1 resource from src/test/resources to target/test-classes
[INFO] 
[INFO] --- compiler:3.13.0:testCompile (default-testCompile) @ inventory ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- surefire:3.5.2:test (default-test) @ inventory ---
[INFO] Using auto detected provider org.apache.maven.surefire.junitplatform.JUnitPlatformProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.economato.inventory.service.StockLedgerServiceIntegrationTest
22:11:22.177 [main] INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils -- Could not detect default configuration classes for test class [com.economato.inventory.service.StockLedgerServiceIntegrationTest]: StockLedgerServiceIntegrationTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
22:11:22.263 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper -- Found @SpringBootConfiguration com.economato.inventory.InventoryApplication for test class com.economato.inventory.service.StockLedgerServiceIntegrationTest
22:11:22.354 [main] INFO org.springframework.boot.devtools.restart.RestartApplicationListener -- Restart disabled due to context in which it is running
Hibernate: set client_min_messages = WARNING
Hibernate: alter table if exists inventory_audit drop constraint if exists fk_inventory_audit_product
Hibernate: alter table if exists inventory_audit drop constraint if exists fk_inventory_audit_user
Hibernate: alter table if exists order_audit drop constraint if exists fk_order_audit_order
Hibernate: alter table if exists order_audit drop constraint if exists fk_order_audit_user
Hibernate: alter table if exists order_detail drop constraint if exists fk_order_detail_order
Hibernate: alter table if exists order_detail drop constraint if exists fk_order_detail_product
Hibernate: alter table if exists order_header drop constraint if exists fk_order_user
Hibernate: alter table if exists product drop constraint if exists fk_product_supplier
Hibernate: alter table if exists recipe_allergen drop constraint if exists FK5ceorq8xo6ht37xq3dmj7xsaa
Hibernate: alter table if exists recipe_allergen drop constraint if exists FKds7dbdp4j946gihsuy4asv2l4
Hibernate: alter table if exists recipe_audit drop constraint if exists fk_recipe_audit_recipe
Hibernate: alter table if exists recipe_audit drop constraint if exists fk_recipe_audit_user
Hibernate: alter table if exists recipe_component drop constraint if exists fk_recipe_component_recipe
Hibernate: alter table if exists recipe_component drop constraint if exists fk_recipe_component_product
Hibernate: alter table if exists recipe_cooking_audit drop constraint if exists fk_cooking_audit_recipe
Hibernate: alter table if exists recipe_cooking_audit drop constraint if exists fk_cooking_audit_user
Hibernate: alter table if exists stock_ledger drop constraint if exists fk_ledger_product
Hibernate: alter table if exists stock_ledger drop constraint if exists fk_ledger_user
Hibernate: alter table if exists stock_snapshot drop constraint if exists fk_snapshot_product
Hibernate: alter table if exists temporary_role_escalation drop constraint if exists FKcy8xji9ev5mun39r2x7vtew42
Hibernate: alter table if exists users drop constraint if exists FKl4tqqawpybawc8af75eyk7cwc
Hibernate: drop table if exists allergen cascade
Hibernate: drop table if exists audit_outbox cascade
Hibernate: drop table if exists inventory_audit cascade
Hibernate: drop table if exists order_audit cascade
Hibernate: drop table if exists order_detail cascade
Hibernate: drop table if exists order_header cascade
Hibernate: drop table if exists product cascade
Hibernate: drop table if exists recipe cascade
Hibernate: drop table if exists recipe_allergen cascade
Hibernate: drop table if exists recipe_audit cascade
Hibernate: drop table if exists recipe_component cascade
Hibernate: drop table if exists recipe_cooking_audit cascade
Hibernate: drop table if exists stock_ledger cascade
Hibernate: drop table if exists stock_snapshot cascade
Hibernate: drop table if exists supplier cascade
Hibernate: drop table if exists temporary_role_escalation cascade
Hibernate: drop table if exists users cascade
Hibernate: create table allergen (allergen_id integer generated by default as identity, name varchar(50) not null unique, primary key (allergen_id))
Hibernate: create table audit_outbox (created_at timestamp(6) not null, id bigint generated by default as identity, event_key varchar(255) not null, payload TEXT not null, topic varchar(255) not null, primary key (id))
Hibernate: create table inventory_audit (audit_id integer generated by default as identity, product_id integer not null, quantity numeric(13,3) not null, user_id integer, movement_date timestamp(6) not null, movement_type varchar(20) not null, action_description varchar(500), new_state TEXT, previous_state TEXT, primary key (audit_id))
Hibernate: create table order_audit (audit_id integer generated by default as identity, order_id integer, user_id integer, audit_date timestamp(6) not null, action varchar(100) not null, details TEXT, new_state TEXT, previous_state TEXT, primary key (audit_id))
Hibernate: create table order_detail (order_id integer not null, product_id integer not null, received_quantity numeric(13,3), requested_quantity numeric(13,3) not null, primary key (order_id, product_id))
Hibernate: create table order_header (order_id integer generated by default as identity, user_id integer not null, order_date timestamp(6) not null, version bigint, status varchar(20) not null, primary key (order_id))
Hibernate: create table product (availability_percentage numeric(5,2), current_stock numeric(13,3) not null, is_hidden boolean not null, minimum_stock numeric(13,3) not null, product_id integer generated by default as identity, supplier_id integer, unit_price numeric(12,2) not null, version bigint, unit_of_measure varchar(20) not null, product_code varchar(50) not null unique, type varchar(50) not null, name varchar(100) not null, primary key (product_id))
Hibernate: create table recipe (is_hidden boolean not null, recipe_id integer generated by default as identity, total_cost numeric(12,2), version bigint, recipe_name varchar(150) not null, presentation TEXT, elaboration TEXT, primary key (recipe_id))
Hibernate: create table recipe_allergen (allergen_id integer not null, id integer generated by default as identity, recipe_id integer not null, primary key (id))
Hibernate: create table recipe_audit (audit_id integer generated by default as identity, recipe_id integer, user_id integer, audit_date timestamp(6) not null, action varchar(100) not null, details TEXT, new_state TEXT, previous_state TEXT, primary key (audit_id))
Hibernate: create table recipe_component (id integer generated by default as identity, parent_recipe_id integer not null, product_id integer not null, quantity numeric(13,3) not null, primary key (id), constraint uk_recipe_component unique (parent_recipe_id, product_id))
Hibernate: create table recipe_cooking_audit (quantity_cooked numeric(13,3) not null, recipe_id integer not null, user_id integer, cooking_audit_id bigint generated by default as identity, cooking_date timestamp(6) not null, details TEXT, components_state TEXT, primary key (cooking_audit_id))
Hibernate: create table stock_ledger (order_id integer, product_id integer not null, quantity_delta numeric(13,3) not null, resulting_stock numeric(13,3) not null, user_id integer, verified boolean not null, sequence_number bigint not null, transaction_id bigint generated by default as identity, transaction_timestamp timestamp(6) not null, movement_type varchar(50) not null check (movement_type in ('ENTRADA','SALIDA','AJUSTE')), current_hash varchar(64) not null unique, previous_hash varchar(64) not null, description varchar(500), primary key (transaction_id))
Hibernate: create table stock_snapshot (current_stock numeric(13,3) not null, product_id integer not null, last_sequence_number bigint not null, last_updated timestamp(6) not null, last_verified timestamp(6), version bigint, integrity_status varchar(20) not null, last_transaction_hash varchar(64) not null, primary key (product_id))
Hibernate: create table supplier (supplier_id integer generated by default as identity, phone varchar(20), email varchar(100), name varchar(100) not null unique, primary key (supplier_id))
Hibernate: create table temporary_role_escalation (id integer generated by default as identity, user_id integer not null unique, expiration_time timestamp(6) not null, primary key (id))
Hibernate: create table users (is_first_login boolean not null, is_hidden boolean not null, teacher_id integer, user_id integer generated by default as identity, role varchar(20) not null check (role in ('ADMIN','CHEF','ELEVATED','USER')), name varchar(100) not null, "user" varchar(100) not null unique, password varchar(255) not null, primary key (user_id))
Hibernate: create index idx_inventory_audit_product on inventory_audit (product_id)
Hibernate: create index idx_inventory_audit_user on inventory_audit (user_id)
Hibernate: create index idx_inventory_audit_date on inventory_audit (movement_date)
Hibernate: create index idx_inventory_audit_type on inventory_audit (movement_type)
Hibernate: create index idx_order_audit_order on order_audit (order_id)
Hibernate: create index idx_order_audit_user on order_audit (user_id)
Hibernate: create index idx_order_audit_date on order_audit (audit_date)
Hibernate: create index idx_order_audit_action on order_audit (action)
Hibernate: create index idx_order_detail_order on order_detail (order_id)
Hibernate: create index idx_order_detail_product on order_detail (product_id)
Hibernate: create index idx_order_status on order_header (status)
Hibernate: create index idx_order_date on order_header (order_date)
Hibernate: create index idx_order_user on order_header (user_id)
Hibernate: create index idx_product_name on product (name)
Hibernate: create index idx_product_type on product (type)
Hibernate: create index idx_recipe_name on recipe (recipe_name)
Hibernate: create index idx_recipe_audit_recipe on recipe_audit (recipe_id)
Hibernate: create index idx_recipe_audit_user on recipe_audit (user_id)
Hibernate: create index idx_recipe_audit_date on recipe_audit (audit_date)
Hibernate: create index idx_recipe_audit_action on recipe_audit (action)
Hibernate: create index idx_recipe_component_recipe on recipe_component (parent_recipe_id)
Hibernate: create index idx_recipe_component_product on recipe_component (product_id)
Hibernate: create index idx_cooking_audit_recipe on recipe_cooking_audit (recipe_id)
Hibernate: create index idx_cooking_audit_user on recipe_cooking_audit (user_id)
Hibernate: create index idx_cooking_audit_date on recipe_cooking_audit (cooking_date)
Hibernate: create index idx_ledger_product on stock_ledger (product_id)
Hibernate: create index idx_ledger_timestamp on stock_ledger (transaction_timestamp)
Hibernate: create index idx_ledger_type on stock_ledger (movement_type)
Hibernate: create index idx_ledger_prev_hash on stock_ledger (previous_hash)
Hibernate: create index idx_snapshot_updated on stock_snapshot (last_updated)
Hibernate: create index idx_escalation_expiration on temporary_role_escalation (expiration_time)
Hibernate: create index idx_user_role on users (role)
Hibernate: alter table if exists inventory_audit add constraint fk_inventory_audit_product foreign key (product_id) references product
Hibernate: alter table if exists inventory_audit add constraint fk_inventory_audit_user foreign key (user_id) references users
Hibernate: alter table if exists order_audit add constraint fk_order_audit_order FOREIGN KEY (order_id) REFERENCES order_header(order_id) ON DELETE SET NULL
Hibernate: alter table if exists order_audit add constraint fk_order_audit_user foreign key (user_id) references users
Hibernate: alter table if exists order_detail add constraint fk_order_detail_order foreign key (order_id) references order_header
Hibernate: alter table if exists order_detail add constraint fk_order_detail_product foreign key (product_id) references product
Hibernate: alter table if exists order_header add constraint fk_order_user foreign key (user_id) references users
Hibernate: alter table if exists product add constraint fk_product_supplier foreign key (supplier_id) references supplier
Hibernate: alter table if exists recipe_allergen add constraint FK5ceorq8xo6ht37xq3dmj7xsaa foreign key (allergen_id) references allergen
Hibernate: alter table if exists recipe_allergen add constraint FKds7dbdp4j946gihsuy4asv2l4 foreign key (recipe_id) references recipe
Hibernate: alter table if exists recipe_audit add constraint fk_recipe_audit_recipe FOREIGN KEY (recipe_id) REFERENCES recipe(recipe_id) ON DELETE SET NULL
Hibernate: alter table if exists recipe_audit add constraint fk_recipe_audit_user foreign key (user_id) references users
Hibernate: alter table if exists recipe_component add constraint fk_recipe_component_recipe foreign key (parent_recipe_id) references recipe
Hibernate: alter table if exists recipe_component add constraint fk_recipe_component_product foreign key (product_id) references product
Hibernate: alter table if exists recipe_cooking_audit add constraint fk_cooking_audit_recipe foreign key (recipe_id) references recipe
Hibernate: alter table if exists recipe_cooking_audit add constraint fk_cooking_audit_user foreign key (user_id) references users
Hibernate: alter table if exists stock_ledger add constraint fk_ledger_product foreign key (product_id) references product
Hibernate: alter table if exists stock_ledger add constraint fk_ledger_user foreign key (user_id) references users
Hibernate: alter table if exists stock_snapshot add constraint fk_snapshot_product foreign key (product_id) references product
Hibernate: alter table if exists temporary_role_escalation add constraint FKcy8xji9ev5mun39r2x7vtew42 foreign key (user_id) references users
Hibernate: alter table if exists users add constraint FKl4tqqawpybawc8af75eyk7cwc foreign key (teacher_id) references users
2026-02-26T22:11:27.200Z  WARN 376373 --- [inventory] [           main] ion$DefaultTemplateResolverConfiguration : Cannot find template location: classpath:/templates/ (please add some templates, check your Thymeleaf configuration, or set spring.thymeleaf.check-template-location=false)
Hibernate: select tre1_0.id,tre1_0.expiration_time,tre1_0.user_id from temporary_role_escalation tre1_0
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
2026-02-26T22:11:28.110Z ERROR 376373 --- [inventory] [           main] c.e.i.service.StockLedgerService         : CORRUPCIÓN DETECTADA: 2 errores encontrados
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: update product set availability_percentage=?,current_stock=?,is_hidden=?,minimum_stock=?,name=?,product_code=?,supplier_id=?,type=?,unit_of_measure=?,unit_price=?,version=? where product_id=? and version=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
2026-02-26T22:11:28.132Z ERROR 376373 --- [inventory] [           main] c.e.i.service.StockLedgerService         : CORRUPCIÓN DETECTADA: 1 errores encontrados
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: update product set availability_percentage=?,current_stock=?,is_hidden=?,minimum_stock=?,name=?,product_code=?,supplier_id=?,type=?,unit_of_measure=?,unit_price=?,version=? where product_id=? and version=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 join product p1_0 on p1_0.product_id=sl1_0.product_id where p1_0.product_id=?
Hibernate: delete from stock_ledger where transaction_id=?
Hibernate: delete from stock_snapshot where product_id=? and version=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: update product set availability_percentage=?,current_stock=?,is_hidden=?,minimum_stock=?,name=?,product_code=?,supplier_id=?,type=?,unit_of_measure=?,unit_price=?,version=? where product_id=? and version=?
Hibernate: update stock_snapshot set current_stock=?,integrity_status=?,last_sequence_number=?,last_transaction_hash=?,last_updated=?,last_verified=?,version=? where product_id=? and version=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
2026-02-26T22:11:28.181Z ERROR 376373 --- [inventory] [           main] c.e.i.service.StockLedgerService         : CORRUPCIÓN DETECTADA: 2 errores encontrados
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: update product set availability_percentage=?,current_stock=?,is_hidden=?,minimum_stock=?,name=?,product_code=?,supplier_id=?,type=?,unit_of_measure=?,unit_price=?,version=? where product_id=? and version=?
Hibernate: update product set availability_percentage=?,current_stock=?,is_hidden=?,minimum_stock=?,name=?,product_code=?,supplier_id=?,type=?,unit_of_measure=?,unit_price=?,version=? where product_id=? and version=?
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: update product set availability_percentage=?,current_stock=?,is_hidden=?,minimum_stock=?,name=?,product_code=?,supplier_id=?,type=?,unit_of_measure=?,unit_price=?,version=? where product_id=? and version=?
Hibernate: update stock_snapshot set current_stock=?,integrity_status=?,last_sequence_number=?,last_transaction_hash=?,last_updated=?,last_verified=?,version=? where product_id=? and version=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
2026-02-26T22:11:28.277Z ERROR 376373 --- [inventory] [           main] c.e.i.service.StockLedgerService         : CORRUPCIÓN DETECTADA: 3 errores encontrados
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0
Hibernate: insert into product (availability_percentage,current_stock,is_hidden,minimum_stock,name,product_code,supplier_id,type,unit_of_measure,unit_price,version) values (?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select ss1_0.product_id,ss1_0.current_stock,ss1_0.integrity_status,ss1_0.last_sequence_number,ss1_0.last_transaction_hash,ss1_0.last_updated,ss1_0.last_verified,ss1_0.version from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_snapshot (current_stock,integrity_status,last_sequence_number,last_transaction_hash,last_updated,last_verified,version,product_id) values (?,?,?,?,?,?,?,?)
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number desc fetch first 1 rows only
Hibernate: insert into stock_ledger (current_hash,description,movement_type,order_id,previous_hash,product_id,quantity_delta,resulting_stock,sequence_number,transaction_timestamp,user_id,verified) values (?,?,?,?,?,?,?,?,?,?,?,?)
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: update product set availability_percentage=?,current_stock=?,is_hidden=?,minimum_stock=?,name=?,product_code=?,supplier_id=?,type=?,unit_of_measure=?,unit_price=?,version=? where product_id=? and version=?
Hibernate: update stock_snapshot set current_stock=?,integrity_status=?,last_sequence_number=?,last_transaction_hash=?,last_updated=?,last_verified=?,version=? where product_id=? and version=?
Hibernate: select count(*) from stock_snapshot ss1_0 where ss1_0.product_id=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 join product p1_0 on p1_0.product_id=sl1_0.product_id where p1_0.product_id=?
Hibernate: delete from stock_ledger where transaction_id=?
Hibernate: delete from stock_ledger where transaction_id=?
Hibernate: delete from stock_ledger where transaction_id=?
Hibernate: delete from stock_snapshot where product_id=? and version=?
Hibernate: select sl1_0.transaction_id,sl1_0.current_hash,sl1_0.description,sl1_0.movement_type,sl1_0.order_id,sl1_0.previous_hash,sl1_0.product_id,sl1_0.quantity_delta,sl1_0.resulting_stock,sl1_0.sequence_number,sl1_0.transaction_timestamp,sl1_0.user_id,sl1_0.verified from stock_ledger sl1_0 where sl1_0.product_id=? order by sl1_0.sequence_number
Hibernate: select count(*) from stock_snapshot ss1_0 where ss1_0.product_id=?
[INFO] Tests run: 17, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 6.184 s -- in com.economato.inventory.service.StockLedgerServiceIntegrationTest
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 17, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] 
[INFO] --- jacoco:0.8.12:report (report) @ inventory ---
[INFO] Loading execution data file /home/franchu/Escritorio/Cosas/turing/target/jacoco.exec
[INFO] Analyzed bundle 'inventory' with 106 classes
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  7.644 s
[INFO] Finished at: 2026-02-26T22:11:28Z
[INFO] ------------------------------------------------------------------------
